<div
  class="relative border-2 border-[var(--Rouge)] bg-[var(--Blanc)] rounded-2xl flex flex-col justify-between text-center shadow-md aspect-square w-full max-w-[400px] mx-auto p-6"
  role="region"
  aria-label="Liste des joueurs"
>
  <h3 class="text-lg font-bold text-[var(--Black)] mb-3">
    Liste des joueurs
  </h3>

  <!-- Liste des joueurs -->
  <ul
    *ngIf="!loading && paginatedJoueurs.length"
    class="flex-1 overflow-y-auto space-y-2 pr-1 scrollbar-thin scrollbar-thumb-[var(--Rouge)]/40 scrollbar-track-transparent"
  >
    <li
      *ngFor="let j of paginatedJoueurs; trackBy: trackById"
      (click)="openPlayerModal(j)"
      class="cursor-pointer flex items-center gap-3 p-2 rounded-xl bg-[var(--Blanc)] border border-[var(--Rouge)]/10 hover:bg-[var(--Rouge)]/5 transition"
    >
      <div
        class="w-10 h-10 rounded-full bg-gradient-to-br from-[var(--Rouge)] to-[var(--Rouge-Foncé)] flex items-center justify-center text-[var(--Blanc)] font-bold text-sm"
      >
        {{ j.initiale || '?' }}
      </div>

      <div class="flex-1 min-w-0 text-left">
        <p class="font-semibold text-[var(--Black)] truncate">
          {{ j.prenom }} {{ j.nom }}
        </p>
        <div class="flex flex-wrap gap-1 mt-1">
          <span
            *ngIf="j.club"
            class="px-2 py-0.5 text-xs rounded-full bg-[var(--Rouge)]/10 text-[var(--Rouge)]"
          >
            {{ j.club }}
          </span>
          <span
            *ngIf="j.equipe"
            class="px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-700"
          >
            {{ j.equipe }}
          </span>
        </div>
      </div>
    </li>
  </ul>

  <p *ngIf="!loading && !joueurs.length" class="text-center text-gray-500 mt-2">
    Aucun joueur trouvé.
  </p>

  <!-- Pagination -->
  <div class="flex items-center justify-center gap-2 mt-3">
    <button
      (click)="prevPage()" [disabled]="currentPage === 1"
      class="px-3 py-1.5 rounded-lg bg-[var(--Rouge)] text-[var(--Blanc)] text-sm font-medium
             disabled:bg-gray-300 hover:enabled:bg-[var(--Rouge-Foncé)] transition"
    >
      Précédent
    </button>

    <span class="text-sm text-[var(--Black)]">
      {{ currentPage }} / {{ totalPages }}
    </span>

    <button
      (click)="nextPage()" [disabled]="currentPage === totalPages"
      class="px-3 py-1.5 rounded-lg bg-[var(--Rouge)] text-[var(--Blanc)] text-sm font-medium
             disabled:bg-gray-300 hover:enabled:bg-[var(--Rouge-Foncé)] transition"
    >
      Suivant
    </button>
  </div>

  <!-- Indicateur bas -->
  <div class="w-16 h-1.5 rounded-full bg-[var(--Rouge)] mx-auto mt-2"></div>
</div>

<!-- Modal joueur -->
<div
  *ngIf="showModal && selectedJoueur"
  class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 transition-opacity duration-300"
  [class.opacity-0]="!showModal"
  [class.opacity-100]="showModal"
  (click)="closeModal()"
  role="dialog"
  aria-modal="true"
  [attr.aria-labelledby]="'joueur-modal-title'"
>
  <div
    class="bg-white rounded-2xl p-6 w-11/12 max-w-sm shadow-2xl transform transition-all duration-300 scale-95"
    [class.scale-100]="showModal"
    (click)="$event.stopPropagation()"
  >
    <!-- Bouton fermeture -->
    <button
      (click)="closeModal()"
      aria-label="Fermer"
      class="absolute top-4 right-4 text-gray-400 hover:text-red-500 transition-colors"
    >
      <i class="fas fa-times fa-lg"></i>
    </button>

    <!-- Avatar + Nom -->
    <div class="flex items-center gap-4 mb-4">
      <div class="w-14 h-14 rounded-full bg-gradient-to-br from-[var(--Rouge-Foncé)] to-[var(--Rouge)] text-white flex items-center justify-center font-bold text-lg">
        {{ getInitials(selectedJoueur.prenom, selectedJoueur.nom) }}
      </div>
      <div>
        <h2 id="joueur-modal-title" class="text-lg font-semibold text-gray-900">
          {{ selectedJoueur.prenom }} {{ selectedJoueur.nom }}
        </h2>
        <a
          [href]="'mailto:' + selectedJoueur.email"
          class="text-sm text-blue-600 hover:underline"
        >
          {{ selectedJoueur.email || 'Email non disponible' }}
        </a>
      </div>
    </div>

    <!-- Infos -->
    <div class="space-y-2 text-sm text-gray-700">
      <div class="flex items-center gap-2">
        <i class="fas fa-building text-gray-400"></i>
        <span><strong>Club:</strong> {{ selectedJoueur.club || 'ASDAM' }}</span>
      </div>
      <div class="flex items-center gap-2">
        <i class="fas fa-users text-gray-400"></i>
        <span><strong>Équipe:</strong> {{ selectedJoueur.equipe || 'Non renseigné' }}</span>
      </div>
    </div>
  </div>
</div>
