<!-- ==========  CONVOCATIONS – UI 2025 « TAILWIND ONLY »  ========== -->
<section class="relative isolate flex min-h-screen items-center justify-center bg-gray-50 text-gray-900 overflow-hidden"
  aria-labelledby="convoc-title">

  <div class="w-full max-w-6xl px-4 sm:px-6 lg:px-8 py-12 lg:py-20">

    <!-- =====  EN-TÊTE  ===== -->
    <header *ngIf="!loading && userInConvocations.length" class="mx-auto max-w-3xl text-center mb-12 lg:mb-16">
      <p class="text-xs sm:text-sm uppercase tracking-[0.3em] text-gray-500 mb-2">
        Convocation officielle
      </p>
      <h1 id="convoc-title"
        class="text-4xl sm:text-5xl md:text-6xl font-extrabold bg-gradient-to-r from-gray-900 via-gray-800 to-rose-600 bg-clip-text text-transparent drop-shadow-sm mb-4">
        Liste des joueurs
      </h1>
      <div
        class="flex flex-wrap items-center justify-center gap-x-2 gap-y-1 text-gray-700 text-base sm:text-lg md:text-xl">
        <span class="font-medium">{{ userInConvocations[0].date | date:'fullDate':'':'fr' }}</span>
        <span aria-hidden="true" class="text-gray-400">•</span>
        <span class="font-medium">à {{ userInConvocations[0].date | date:'shortTime':'':'fr' }}</span>
        <span aria-hidden="true" class="text-gray-400">•</span>
        <span class="font-medium">au {{ userInConvocations[0].lieu }}</span>
      </div>
      <p class="mt-4 text-xl sm:text-2xl font-bold text-rose-600 tracking-wide">
        {{ userInConvocations[0].match }}
      </p>
    </header>

    <!-- =====  LOADER  ===== -->
    <div *ngIf="loading" class="flex flex-col items-center gap-4 text-gray-500" aria-busy="true">
      <span class="w-8 h-8 border-2 border-gray-300 border-t-rose-600 rounded-full animate-spin"></span>
      <span class="text-sm sm:text-base">Chargement des convocations…</span>
    </div>

    <!-- =====  GRILLE DES CONVOCATIONS  ===== -->
    <div *ngIf="!loading && userInConvocations.length" class="flex justify-center w-full">
      <ul role="list" class="grid gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 w-full max-w-5xl">
        <li *ngFor="let c of userInConvocations; index as i" class="group relative bg-white/70 backdrop-blur-md rounded-2xl p-5 border border-gray-200
                 hover:border-rose-500 hover:-translate-y-1 hover:shadow-xl hover:shadow-rose-500/10
                 transition-all duration-300 ease-out">
          <span
            class="absolute top-3 right-3 h-2 w-2 rounded-full bg-rose-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>

          <ul role="list" class="mt-4 space-y-3">
            <li *ngFor="let joueur of c.joueurs; index as j" role="listitem"
              class="flex items-center gap-3 px-3 py-2 rounded-lg transition" [ngClass]="{
                'bg-amber-100 font-semibold ring-2 ring-amber-300': userConnecte && joueur.nom === userConnecte.nom && joueur.prenom === userConnecte.prenom,
                'bg-green-100': joueur.etatPresence === 'present',
                'bg-red-100': joueur.etatPresence === 'absent'
              }">
              <span class="w-6 text-center font-semibold text-gray-500 text-sm sm:text-base">{{ j + 1 }}</span>

              <div
                class="w-9 h-9 flex items-center justify-center rounded-full bg-gradient-to-br from-rose-600 to-rose-500 text-white font-bold text-xs sm:text-sm shadow"
                aria-hidden="true">
                {{ (joueur.prenom?.charAt(0) || '') + (joueur.nom?.charAt(0) || '') | uppercase }}
              </div>

              <span class="text-gray-900 text-sm sm:text-base leading-tight">
                {{ joueur.prenom }} {{ joueur.nom }}
              </span>

              <!-- Boutons présence pour le joueur connecté -->
              <div *ngIf="userConnecte && joueur.nom === userConnecte.nom && joueur.prenom === userConnecte.prenom"
                class="ml-auto flex gap-2">
                <!-- Bouton Présent -->
                <button (click)="updatePresence(c, userConnecte, true)" [ngClass]="{
    'bg-green-500 hover:bg-green-600 ring-2 ring-green-400': joueur.etatPresence !== 'present',
    'bg-green-700': joueur.etatPresence === 'present'
  }" class="px-3 py-1 rounded-md text-white text-xs sm:text-sm focus:outline-none transition"
                  aria-label="Je serai présent">
                  ✅ Présent
                </button>

                <!-- Bouton Absent -->
                <button (click)="updatePresence(c, userConnecte, false)" [ngClass]="{
    'bg-red-500 hover:bg-red-600 ring-2 ring-red-400': joueur.etatPresence !== 'absent',
    'bg-red-700': joueur.etatPresence === 'absent'
  }" class="px-3 py-1 rounded-md text-white text-xs sm:text-sm focus:outline-none transition"
                  aria-label="Je ne serai pas là">
                  ❌ Absent
                </button>
              </div>

            </li>
          </ul>
        </li>
      </ul>
    </div>

    <!-- =====  ÉTAT VIDE  ===== -->
    <div *ngIf="!loading && !userInConvocations.length" class="text-center py-24 px-4 sm:px-0" role="status">
      <p class="text-gray-400 text-base sm:text-lg">Aucune convocation pour le moment.</p>
    </div>

    <!-- =====  MESSAGE D’ERREUR  ===== -->
    <div *ngIf="error" class="text-center py-24 px-4 sm:px-0 text-rose-600" role="alert">
      <p class="text-base sm:text-lg">{{ error }}</p>
    </div>
  </div>
</section>